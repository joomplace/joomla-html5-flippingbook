function shareAjaxAction(e){var t="";var n=parseInt(jQuery('#jomshareModal input[name="publID"]').val());if(!n){alert(Joomla.JText._("COM_HTML5FLIPPINGBOOK_FE_JSSHARE_PUB_ERROR"));return false}if(e=="sendprivate"){if(jQuery("#jomshareModal #friends").val()==-1){alert(Joomla.JText._("COM_HTML5FLIPPINGBOOK_FE_JSSHARE_FRIEND_ERROR"));return false}t={to:jQuery("#jomshareModal #friends").val(),subject:jQuery("#jomshareModal #subject").val(),body:jQuery("#jomshareModal #body").val()}}jQuery.ajax({type:"POST",url:liveSite+"index.php?option=com_html5flippingbook&task=jomShare&tmpl=component",data:{pubID:n,action:e,data:JSON.stringify(t)},dataType:"JSON",success:function(e){if(e.error==1){alert(e.message);return false}alert(e.message);jQuery("#jomshareModal").modal("hide");return true}});return true}function showPrivate(){jQuery("#jomshareModal .button-block").slideUp("fast",function(){jQuery("#jomshareModal .form-horizontal").slideDown("fast")})}function backToTop(){jQuery("html, body").animate({scrollTop:"0px"},800)}function userPublAction(e,t,n){var r=["reading","favorite","read","reading_remove","favorite_remove","read_remove","sendtofriend","share"];var i={reading:".icon-list-2",favorite:".icon-star",read:".icon-eye-blocked"};if(jQuery.inArray(t,r)!=-1){if(!user){alert(Joomla.JText._("COM_HTML5FLIPPINGBOOK_FE_ACTION_ERROR_USER"));return false}if(t=="sendtofriend"){jQuery('#emailModal input[name="publID"]').val(e);jQuery("#emailModal").modal("show");return false}if(t=="share"){jQuery('#jomshareModal input[name="publID"]').val(e);jQuery("#jomshareModal").modal("show");return false}jQuery.ajax({type:"POST",url:liveSite+"index.php?option=com_html5flippingbook&task=userPublAction&tmpl=component",data:{pubID:e,action:t},dataType:"JSON",success:function(r){var i=jQuery("."+n+"-pub-"+e);if(!r.error){i.find(".list-overlay").addClass("done").fadeIn(150).delay(5).fadeOut(150,function(){if(t=="reading_remove"||t=="favorite_remove"){i.slideUp("fast").remove()}var r=null,s=0;if(t=="read"){i.addClass("hide-publ").hide();r=jQuery("a#read_"+e);for(s=0;s<r.length;s++){jQuery(r[s]).attr("onclick","userPublAction("+e+", 'read_remove', '"+n+"'); return false;")}jQuery("#read_"+e+" > i.fa-eye-slash").removeClass("fa-eye-slash").addClass("fa-eye");jQuery("#read_"+e+" > #text_"+e).text(Joomla.JText._("COM_HTML5FLIPPINGBOOK_FE_ACTION_REMOVE_READ"))}else if(t=="read_remove"){i.removeClass("hide-publ");r=jQuery("a#read_"+e);for(s=0;s<r.length;s++){jQuery(r[s]).attr("onclick","userPublAction("+e+", 'read', '"+n+"'); return false;")}jQuery("a#read_"+e+" > i.fa-eye").removeClass("fa-eye").addClass("fa-eye-slash");jQuery("a#read_"+e+" > #text_"+e).text(Joomla.JText._("COM_HTML5FLIPPINGBOOK_FE_ACTION_READ_TIP"))}if(!jQuery("ul#"+n+"-list > li:not(.hide-publ)").length){jQuery("#"+n+"-alert").show()}})}else if(r.error==1){i.find(".list-overlay").addClass("error").fadeIn(150).delay(5).fadeOut(150,function(){alert(r.message)});return false}return true}})}else{alert(Joomla.JText._("COM_HTML5FLIPPINGBOOK_FE_ACTION_ERROR_ACTION"));return false}return true}(function(e){e(function(){var t=false;var n="reading";var r="",i="",s=0;e('a[data-toggle="tab"]').on("shown",function(o){e.cookie("last_tab",e(o.target).attr("href"));n=e(o.target).attr("href").split("_")[1];t=false;if(r.length>1){for(var u=1;u<r.length;u++){e(r[u]).css("left",-1*s+"px")}for(var a=1;a<i.length;a++){e(i[a]).css("left",-1*s+"px")}}});var o=e.cookie("last_tab");if(o){e("ul.nav-tabs").children().removeClass("active");e("a[href="+o+"]").parents("li:first").addClass("active");e("div.tab-content").children().removeClass("active");e(o).addClass("active");n=o.split("_")[1]}else{e("#viewTabs a:first").tab("show")}r=e("#tab_"+n+" .row-1 .loc");i=e("#tab_"+n+" .row-2 .loc");s=parseInt(r.actual("width"));var u=r.first();var a=i.first();var f=r.last();var l=i.last();if(r.length>1){for(var c=1;c<r.length;c++){e(r[c]).css("left",-1*s+"px")}for(var h=1;h<i.length;h++){e(i[h]).css("left",-1*s+"px")}e("#tab_"+n+" .slide-navi").show();e(".htmlfb5-sl-next").on("click",function(){u.animate({left:s},200,function(){f.animate({left:0},200,function(){u.before(f);u=e("#tab_"+n+" .row-1 .loc:first");f=e("#tab_"+n+" .row-1 .loc:last");f.css("left",-1*s)})});a.animate({left:s},200,function(){l.animate({left:0},200,function(){a.before(l);a=e("#tab_"+n+" .row-2 .loc:first");l=e("#tab_"+n+" .row-2 .loc:last");l.css("left",-1*s)})})});e(".htmlfb5-sl-prev").on("click",function(){u.animate({left:-1*s},200,function(){f.after(u);u=e("#tab_"+n+" .row-1 .loc:first");f=e("#tab_"+n+" .row-1 .loc:last");u.css("left",s).animate({left:0},200)});a.animate({left:-1*s},200,function(){l.after(a);a=e("#tab_"+n+" .row-2 .loc:first");l=e("#tab_"+n+" .row-2 .loc:last");a.css("left",s).animate({left:0},200)})})}var p=3;var d=3;e(window).scroll(function(){if(e(window).scrollTop()>=e(".html5fb-profile").height()-e(window).height()&&!t){e(".content-loading").show();e.ajax({url:"index.php?option=com_html5flippingbook&task=getAjaxContent&tmpl=component",method:"POST",data:{start:n=="reading"?p:d,list:n},dataType:"HTML",beforeSend:function(){t=true}}).done(function(r){if(r.length>0){e("#"+n+"-list").append(r);t=false;if(n=="reading"){p+=3}else{d+=3}}else{e.ajax({url:"index.php?option=com_html5flippingbook&task=getAjaxContent&tmpl=component",method:"POST",data:{start:0,list:n}})}e(".content-loading").hide()})}});e(document).on({mouseenter:function(){e(this).find(".html5fb-top").fadeIn("fast")},mouseleave:function(){e(this).find(".html5fb-top").fadeOut("fast")}},".html5fb-list-item");e('a[href="#tab_reading"], a[href="#tab_favorite"]').on("click",function(){var n=e(this);var r=e(n.attr("href")+" > div.bookshelf").hasClass("active");var i=e("#"+n.attr("href").split("_")[1]+"-list").hasClass("active");if(r){e("#list").removeClass("active");e("#bookshelf").removeClass("active").addClass("active");t=true}else if(i){e("#bookshelf").removeClass("active");e("#list").removeClass("active").addClass("active");t=false}});e("#read-publ").on("click",function(){var t=jQuery("#viewTabs > li.active > a").attr("href");var n=jQuery(this);if(n.hasClass("active")){n.removeClass("active");e(t+" .hide-publ").hide();if(!e("ul#"+t.split("_")[1]+"-list > li:not(.hide-publ)").length){e("#"+t.split("_")[1]+"-alert").show()}n.attr("data-original-title",Joomla.JText._("COM_HTML5FLIPPINGBOOK_FE_DISPLAY_READ_PUBL"));n.find("i.fa-eye").removeClass("fa-eye").addClass("fa-eye-slash")}else{n.addClass("active");e(t+" .hide-publ").show();if(!jQuery("ul#"+t.split("_")[1]+"-list > li:not(.hide-publ)").length){jQuery("#"+t.split("_")[1]+"-alert").hide()}n.attr("data-original-title",Joomla.JText._("COM_HTML5FLIPPINGBOOK_FE_DISPLAY_UNREAD_PUBL"));n.find("i.fa-eye-slash").removeClass("fa-eye-slash").addClass("fa-eye")}});e("#list, #bookshelf").on("click",function(){var n=e("#viewTabs > li.active > a").attr("href");e(this).addClass("active");e("#"+(this.id=="list"?"bookshelf":this.id=="bookshelf"?"list":"")).removeClass("active");if(this.id=="list"){e("#"+n.split("_")[1]+"-list").addClass("active").show();e(n+" > div.bookshelf").removeClass("active").hide();t=false}else if(this.id=="bookshelf"){e("#"+n.split("_")[1]+"-list").removeClass("active").hide();e(n+" > div.bookshelf").addClass("active").show();t=true}});e("#jomshareModal").on("show",function(){e("#jomshareModal .button-block").show();var t=e('#jomshareModal input[name="publID"]').val();var n=e(".pub-"+t);var r=jQuery.trim(jQuery(n.find("a")[0]).text());if(!r){r=n.attr("alt")}var i="Dear Friend!\r\n\r\nCheck out the link below:\r\n"+liveSite+"index.php?option=com_html5flippingbook&view=publication&id="+t+"&tmpl=component";e("#jomshareModal .form-horizontal #subject").val(r);e("#jomshareModal .form-horizontal #body").val(i);e("#jomshareModal .form-horizontal").hide()})})})(jQuery)